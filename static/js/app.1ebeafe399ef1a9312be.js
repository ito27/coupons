webpackJsonp([5],{"1/oy":function(t,e){},"9M+g":function(t,e){},GfHa:function(t,e){},Id91:function(t,e){},Jmt5:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={};n.d(r,"fetchItems",function(){return j}),n.d(r,"signOut",function(){return P}),n.d(r,"loginWithGoogleAuth",function(){return W}),n.d(r,"reportCouponError",function(){return D});var a=n("7+uW"),o=n("Dd8w"),u=n.n(o),s=n("/ocq");a.a.use(s.a);var c=function(){return n.e(0).then(n.bind(null,"UheU"))},i=function(){return n.e(1).then(n.bind(null,"xQGZ"))},p=["ImageUploader","ItemForm"],l=[{key:"CouponForm",name:"登錄優惠券"},{key:"CouponTable",name:"優惠券列表"}];var f=new s.a({routes:[{path:"/",component:i},{path:"/CouponTable",component:i},{path:"/CouponForm",component:c}]}),v=n("SSY3"),d=n("NYxO"),h={name:"navibar",data:function(){return{components:p,pages:l}},mounted:function(){this.init()},computed:u()({},Object(d.d)(["userInfomation","alertMessage"])),methods:u()({},Object(d.b)(["loginWithGoogleAuth","signOut"]),Object(d.c)(["SET_USERINFO"]),{setUserInfo:function(){var t=v.b.user();t&&this.$store.commit("SET_USERINFO",t)},init:function(){var t=this;setTimeout(function(){t.setUserInfo()},1e3)}})},m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-navbar",[n("b-navbar-nav",{staticClass:"mr-auto"},[n("b-dropdown",{attrs:{id:"ddown-left",text:"功能表"}},t._l(t.pages,function(e){return n("b-dropdown-item",{key:e.key,attrs:{to:"/"+e.key}},[t._v("\n        "+t._s(e.name)+"\n      ")])}))],1),t._v(" "),n("b-navbar-nav",{staticClass:"ml-auto"},[t.userInfomation?n("b-nav-item",[t._v("\n      "+t._s(t.userInfomation.displayName)+"\n      "),n("b-btn",{attrs:{variant:"outline-danger"},on:{click:function(e){t.signOut()}}},[t._v("登出")])],1):n("b-nav-item",[n("b-btn",{attrs:{variant:"outline-success"},on:{click:function(e){t.loginWithGoogleAuth()}}},[t._v("Google登入")])],1),t._v(" "),t.alertMessage?n("b-alert",{attrs:{show:""}},[t._v(t._s(t.alertMessage.message))]):t._e()],1)],1)},staticRenderFns:[]},b={name:"App",components:{navibar:n("VU/8")(h,m,!1,null,null,null).exports}},g={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("navibar"),this._v(" "),e("router-view")],1)},staticRenderFns:[]};var E,S,_,x,T,k=n("VU/8")(b,g,!1,function(t){n("jFNt")},null,null).exports,w=n("bOdI"),A=n.n(w),O=(E={},A()(E,"STORE_COUPONS",function(t,e){t.coupons=e}),A()(E,"CHANGE_UPLOAD_RESULT",function(t,e){t.uploadResult=e}),A()(E,"SET_ALERTMESSAGE",function(t,e){t.alertMessage=e,setTimeout(function(){t.alertMessage=null},5e3)}),A()(E,"SET_USERINFO",function(t,e){e?(t.userInfomation=e,t.login=!0):(t.userInfomation=null,t.login=!1)}),E),I=n("Xxa5"),U=n.n(I),y=n("woOf"),G=n.n(y),R=n("fZjL"),C=n.n(R),M=n("exGp"),N=n.n(M),F=this,L=new v.a,j=(S=N()(U.a.mark(function t(e){var n,r,a=e.commit;return U.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,L.getAllCoupons();case 2:n=t.sent,r=[],n.forEach(function(t){var e=t.id,n=t.data(),a=["deletehash","userId"],o=C()(n).filter(function(t){return!a.includes(t)}).reduce(function(t,e){return t[e]=n[e],t},{});G()(o,{is_selected:!1},{doc_id:e}),r.push(o)}),a("STORE_COUPONS",r);case 6:case"end":return t.stop()}},t,F)})),function(t){return S.apply(this,arguments)}),P=(_=N()(U.a.mark(function t(e){var n,r=e.commit;return U.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,v.b.signOut();case 3:n=t.sent,r("SET_USERINFO",n),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),r("SET_ALERTMESSAGE",t.t0);case 10:case"end":return t.stop()}},t,F,[[0,7]])})),function(t){return _.apply(this,arguments)}),W=(x=N()(U.a.mark(function t(e){var n,r=e.commit;return U.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,v.b.googleAuth();case 3:n=t.sent,r("SET_USERINFO",n.user),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),r("SET_ALERTMESSAGE",t.t0);case 10:case"end":return t.stop()}},t,F,[[0,7]])})),function(t){return x.apply(this,arguments)}),D=(T=N()(U.a.mark(function t(e,n){var r,a=e.commit;return U.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.split("/"),t.prev=1,t.next=4,L.setCouponError(r[0]);case 4:t.sent,a("SET_ALERTMESSAGE",{message:r[1]+"錯誤已回報"}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),a("SET_ALERTMESSAGE",t.t0);case 11:case"end":return t.stop()}},t,F,[[1,8]])})),function(t,e){return T.apply(this,arguments)});a.a.use(d.a);var H=new d.a.Store({state:{coupons:[],login:!1,userInfomation:null,alertMessage:null},mutations:O,actions:r}),Y=n("e6fC");n("Jmt5"),n("9M+g");a.a.config.productionTip=!1,a.a.use(Y.a),new a.a({el:"#app",router:f,store:H,components:{App:k},template:"<App/>"})},SSY3:function(t,e,n){"use strict";n.d(e,"a",function(){return b});var r=n("Xxa5"),a=n.n(r),o=n("exGp"),u=n.n(o),s=n("Zrlr"),c=n.n(s),i=n("wxAW"),p=n.n(i),l=n("yviF"),f=n.n(l),v=(n("dih4"),n("881v"),this),d=function(t){var e=t.config;return f.a.initializeApp(e),f.a}({config:{apiKey:"AIzaSyD7j-RBwWtmLkk0AYCuk5MXnB8GaxBPqHE",authDomain:"coupons-b668a.firebaseapp.com",databaseURL:"https://coupons-b668a.firebaseio.com",projectId:"coupons-b668a"}});d.firestore().settings({timestampsInSnapshots:!0});var h,m,b=function(){function t(){c()(this,t),d.firestore().settings({timestampsInSnapshots:!0})}return p()(t,[{key:"getAllCoupons",value:function(){return d.firestore().collection("coupons").get()}},{key:"setCouponError",value:function(t){var e={error_reporter:d.auth().currentUser.uid,error_status:!0};return d.firestore().collection("coupons").doc(t).update(e)}}]),t}();e.b={fs:(m=u()(a.a.mark(function t(){var e,n,r,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:s=s.toUpperCase(),e=d.firestore().collection("coupons"),t.t0=s,t.next="GET"===t.t0?5:"POST"===t.t0?22:"PUT"===t.t0?30:"DELETE"===t.t0?31:33;break;case 5:return t.prev=5,t.next=8,e.where("id","==",o).get();case 8:if(n=t.sent,r=[],n.forEach(function(t){r.push(t.data())}),!(r.length>0)){t.next=15;break}return t.abrupt("return",r[0]);case 15:return t.abrupt("return",null);case 16:t.next=21;break;case 18:t.prev=18,t.t1=t.catch(5),console.error(t.t1);case 21:return t.abrupt("break",33);case 22:return t.prev=22,t.abrupt("return",e.add(u));case 26:t.prev=26,t.t2=t.catch(22),console.error(t.t2);case 29:case 30:return t.abrupt("break",33);case 31:return t.abrupt("return","done");case 33:case"end":return t.stop()}},t,v,[[5,18],[22,26]])})),function(){return m.apply(this,arguments)}),user:function(){return d.auth().currentUser},signOut:function(){return d.auth().signOut()},googleAuth:(h=u()(a.a.mark(function t(){var e,n;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=new f.a.auth.GoogleAuthProvider,t.prev=1,t.next=4,f.a.auth().signInWithPopup(e);case 4:return n=t.sent,n.credential.accessToken,n.user,t.abrupt("return",n);case 10:t.prev=10,t.t0=t.catch(1),t.t0.code,t.t0.message,t.t0.email,t.t0.credential,console.error(t.t0);case 17:case"end":return t.stop()}},t,v,[[1,10]])})),function(){return h.apply(this,arguments)})}},jFNt:function(t,e){},zj2Q:function(t,e){}},["NHnr"]);