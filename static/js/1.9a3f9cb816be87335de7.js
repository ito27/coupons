webpackJsonp([1],{xQGZ:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("Dd8w"),o=i.n(n),a=i("NYxO"),r={name:"CouponTable",data:function(){return{coupon_selected:null,coupons_data:null,coupons_data_fields:[{key:"id",label:"優惠券代號",sortable:!0},{key:"expiration",label:"到期日",sortable:!0},{key:"actions",label:"優惠券"}],coupons_data_foods_fields:[{key:"name",label:"餐點名稱"},{key:"amount",label:"餐點數量"}]}},mounted:function(){this.init()},computed:o()({},Object(a.c)(["coupons","login","alertMessage"]),{isDataFetched:function(){return!!this.coupons&&(this.coupons_data=this.coupons,!0)}}),methods:o()({},Object(a.b)(["fetchItems","reportCouponError"]),{init:function(){this.fetchItems()},remainTime:function(e){var t=new Date(e)-new Date-288e5,i=Math.round(t/864e5);return i>0?i:0}})},s={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.isDataFetched?i("div",[i("b-table",{attrs:{items:e.coupons_data,fields:e.coupons_data_fields},scopedSlots:e._u([{key:"id",fn:function(t){return[i("div",[i("h3",[i("b-badge",{attrs:{variant:"danger"}},[e._v(e._s(t.item.id))])],1)]),e._v(" "),i("h6",[e._v(e._s(t.item.price)+"元")])]}},{key:"expiration",fn:function(t){return[i("b-button",{directives:[{name:"b-popover",rawName:"v-b-popover.hover.bottom",value:e.remainTime(t.item.expiration)>0?"剩餘"+e.remainTime(t.item.expiration)+"天":"截止",expression:"remainTime(row.item.expiration) > 0 ? `剩餘${remainTime(row.item.expiration)}天`: '截止'",modifiers:{hover:!0,bottom:!0}}],attrs:{variant:e.remainTime(t.item.expiration)>0?"outline-primary":""},on:{click:function(i){e.coupon_selected=t.item.id}}},[e._v("\n          "+e._s(t.item.expiration)+"\n        ")])]}},{key:"actions",fn:function(t){return[i("b-button",{attrs:{variant:t.detailsShowing?"outline-danger":"success"},on:{click:t.toggleDetails}},[e._v(e._s(t.detailsShowing?"關閉":"顯示"))])]}},{key:"row-details",fn:function(t){return[i("b-card-group",{attrs:{deck:""}},[i("b-card",{attrs:{title:"["+t.item.id+"] 價格"+t.item.price+"元","img-src":t.item.img_url}},[i("h6",[e._v(e._s(t.item.name))]),e._v(" "),i("b-alert",{attrs:{show:Boolean(t.item.restriction)}},[e._v("使用限制："+e._s(t.item.restriction))]),e._v(" "),i("b-btn",{attrs:{id:"reportButton-sync",size:"sm"},on:{click:function(e){t.item.is_selected=!t.item.is_selected}}},[e._v("?!")]),e._v(" "),e.alertMessage?i("div",[i("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(t.item.is_selected=!1))])]):e._e(),e._v(" "),i("b-popover",{attrs:{show:t.item.is_selected,placement:"auto",target:"reportButton-sync",title:"優惠券資料怪怪的！？"},on:{"update:show":function(i){e.$set(t.item,"is_selected",i)}}},[e.login?i("div",[i("b-btn",{attrs:{variant:"outline-danger"},on:{click:function(i){e.reportCouponError(t.item.doc_id+"/"+t.item.id)}}},[e._v("回報錯誤")])],1):i("div",[i("p",[e._v("回報錯誤，請先登入")])])])],1),e._v(" "),t.item.foods.length>0?i("b-card",{attrs:{title:"共 "+t.item.foods.length+" 種餐點"}},[i("b-table",{attrs:{items:t.item.foods,fields:e.coupons_data_foods_fields}})],1):e._e()],1),e._v(" "),i("b-button",{attrs:{variant:"danger"},on:{click:t.toggleDetails}},[e._v("關閉")])]}}])})],1):e._e()])},staticRenderFns:[]},c=i("VU/8")(r,s,!1,null,null,null);t.default=c.exports}});